
# Gateway basic
spring.application.name=reactivegateway
server.port=8080
spring.cloud.config.enabled=false

# Disable Eureka registration/fetch when Eureka server is not available locally
eureka.client.register-with-eureka=false
eureka.client.fetch-registry=false
eureka.client.enabled=false
spring.cloud.discovery.enabled=false

# Local route for OAuth2 endpoints â€” forward to utilisateurms running on localhost:9003
spring.cloud.gateway.routes[0].id=oauth2-login
spring.cloud.gateway.routes[0].uri=http://localhost:9003
spring.cloud.gateway.routes[0].predicates[0]=Path=/oauth2/**
spring.cloud.gateway.routes[0].predicates[1]=Path=/login/oauth2/**
spring.cloud.gateway.routes[0].predicates[2]=Path=/loginSuccess
spring.cloud.gateway.routes[0].filters[0]=RewritePath=^/oauth2/(?<segment>.*),/users/oauth2/${segment}
spring.cloud.gateway.routes[0].filters[1]=RewritePath=^/login/oauth2/(?<segment>.*),/users/login/oauth2/${segment}
spring.cloud.gateway.routes[0].filters[2]=RewritePath=^/loginSuccess$,/users/loginSuccess

# Global CORS for the gateway
spring.cloud.gateway.globalcors.cors-configurations[/**].allowed-origins=http://localhost:4200,http://127.0.0.1:4200
spring.cloud.gateway.globalcors.cors-configurations[/**].allowed-methods=GET,POST,PUT,DELETE,OPTIONS
spring.cloud.gateway.globalcors.cors-configurations[/**].allowed-headers=*
spring.cloud.gateway.globalcors.cors-configurations[/**].allow-credentials=true

# Local routes for microservices (direct to ports for local dev)
spring.cloud.gateway.routes[1].id=trajetms
spring.cloud.gateway.routes[1].uri=http://localhost:9004
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/trajets/**
spring.cloud.gateway.routes[1].filters[0]=StripPrefix=1

spring.cloud.gateway.routes[2].id=utilisateurms
spring.cloud.gateway.routes[2].uri=http://localhost:9003
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/users/**
spring.cloud.gateway.routes[2].filters[0]=StripPrefix=1

spring.cloud.gateway.routes[3].id=reservationms
spring.cloud.gateway.routes[3].uri=http://localhost:9002
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/reservations/**
spring.cloud.gateway.routes[3].filters[0]=StripPrefix=1

spring.cloud.gateway.routes[4].id=notificationms
spring.cloud.gateway.routes[4].uri=http://localhost:9001
spring.cloud.gateway.routes[4].predicates[0]=Path=/api/notifications/**
spring.cloud.gateway.routes[4].filters[0]=StripPrefix=1

